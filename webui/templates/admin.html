{% with title='BrazSpeechData' %}
{% include 'header_admin.html' %}
{% endwith %}

<head>

	<style>
		ol {
			list-style-type: none;
		}

		li {
			margin: 10px;
		}


		input:hover {
			background-color: #4a4a4a;
			color: #e3e3e3;
			border-radius: 5px;
		}

		table {
			font-family: arial, sans-serif;
			border-collapse: collapse;
			width: 70%;
			margin-left: 15%;
			margin-top: 30px;
		}

		th {
			color: #b5e853;
		}

		td,
		th {
			border: 1px solid #dddddd;
			text-align: center;
			padding: 8px;
			font-size: 1.1em;
		}

		tr:nth-child(even) {
			background-color: #474747;
		}
	</style>

</head>

<div class='container' style='text-align: center'>
	<section id='main_content'>

		<h1>Welcome to BrazSpeechData.</h1>
		
		<p>O total de áudios anotados é: {{hours.total_audios}}</p>


		<input class="botaoForm" id="botaoGold" type="button" onclick="mostrarFormSelecionado(this.id,'gold')"
			value="Gold" style="height: 35px; width: 130px; margin-top: 15px;" />

		<input class="botaoForm" id="botaoValidados" type="button" onclick="mostrarFormSelecionado(this.id,'naoGold')"
			value="Validados" style="height: 35px; width: 130px; margin-top: 15px;" />


		<form id="gold" method='post' hidden>
			<ol>
				<li><input type='submit' value='Gold Valid' name='Download Valid instances' /></li>
				<li><input type='submit' value='Gold Invalid 1' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Gold Invalid 2' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Gold Invalid 3' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Gold Invalid 4' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Gold Invalid 5' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Gold Invalid 6' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Gold Invalid 7' name='Download Invalid instances' />
				</li>
			</ol>
		</form>

		<form id="naoGold" method='post' hidden>
			<ol>
				<li><input type='submit' value='Valid' name='Download Valid instances' /></li>
				<li><input type='submit' value='Invalid 1' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Invalid 2' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Invalid 3' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Invalid 4' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Invalid 5' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Invalid 6' name='Download Invalid instances' />
				</li>
				<li><input type='submit' value='Invalid 7' name='Download Invalid instances' />
				</li>
			</ol>
		</form>


		<div id='divListaDeUsuarios'>
			<input class="botaoForm" id="listarUsuarios" type="button" value="Listar total horas usuarios"
				style="height: 35px; width: 170px; margin-top: 15px;" onclick="mostrarListaUsuarios()" />
			<p id="todosUsuarios" hidden>{{hours.user_list}}</p>
			<p id="diaAtual" hidden>{{hours.today}}</p>
			<p id="diaComeco" hidden>{{hours.start}}</p>
			<table hidden>
				<tr>
					<th>Usuário</th>
					<th>Data de inicio</th>
					<th>Data de fim</th>
					<th>Horas anotadas</th>
					<th>Horas anotadas + descanso</th>
					<th>Carga horária</th>
				</tr>
			</table>
		</div>

		</form>
	</section>
</div>

<script>

	function controlarBotoes(inputId) {

		document.getElementById(inputId).disabled = true;


		let botaoInverso = inputId === 'botaoGold' ? 'botaoValidados' : 'botaoGold';

		document.getElementById(botaoInverso).disabled = false;

	}

	function mostrarFormSelecionado(inputId, id) {

		let formEscolhido = document.getElementById(id);
		formEscolhido.removeAttribute("hidden");

		let idInverso = id === "gold" ? "naoGold" : "gold";

		let formInverso = document.getElementById(idInverso);
		formInverso.hidden = true;

		controlarBotoes(inputId);
	}


	function calcularDescanso(cargaHoraria) {
		return (1.25 / 20) * cargaHoraria
	}

	function subtraiHoras(elemento1, elemento2) {
		let hora1 = elemento1.split(",")[1];
		let hora2 = elemento2.split(",")[1];

		return hora2 - hora1;
	}

	function mostrarListaUsuarios() {
		document.getElementById("listarUsuarios").disabled = true;

		let listaDatasNaoProcessada = document.getElementById('todosUsuarios').innerHTML;
		let listaDatasProcessada = listaDatasNaoProcessada.split(';').slice(0, -1);

		let listaDatasOrdenada = listaDatasProcessada.sort(subtraiHoras);

		let table = document.querySelector("div > table");
		let diaAtual = document.getElementById("diaAtual").innerHTML;
		let diaComeco = document.getElementById("diaComeco").innerHTML;

		listaDatasOrdenada.forEach(elemento => {
			
			let listaDados = elemento.split(",");
			let tr = document.createElement("tr");

			listaDados[5] = listaDados[3];
			listaDados[2] = parseFloat(listaDados[2]);
			listaDados[2] = (listaDados[2]+calcularDescanso(listaDados[2]));
			listaDados[4] = listaDados[2].toFixed(2);
			listaDados[3] = listaDados[1];
			listaDados[1] = diaComeco;
			listaDados[2] = diaAtual;

			listaDados.forEach(dado => {
				let td = document.createElement("td");
				td.textContent = dado;
				tr.appendChild(td);
			});

			table.appendChild(tr);
		});

		table.hidden = false;
	}

</script>


{% include 'footer.html' %}
